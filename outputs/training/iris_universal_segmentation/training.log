2025-10-18 17:04:05,593 - __main__ - INFO - Logging initialized. Output directory: outputs/training/iris_universal_segmentation
2025-10-18 17:04:05,593 - __main__ - INFO - ==================================================
2025-10-18 17:04:05,593 - __main__ - INFO - IRIS Framework Training
2025-10-18 17:04:05,593 - __main__ - INFO - Universal Medical Image Segmentation via In-Context Learning
2025-10-18 17:04:05,593 - __main__ - INFO - ==================================================
2025-10-18 17:04:05,593 - __main__ - INFO - Configuration: train_config.yaml
2025-10-18 17:04:05,593 - __main__ - INFO - Experiment: iris_universal_segmentation
2025-10-18 17:04:05,593 - __main__ - INFO - Output directory: outputs/training/iris_universal_segmentation
2025-10-18 17:04:05,706 - __main__ - INFO - Using device: cuda
2025-10-18 17:04:05,706 - __main__ - INFO - Loading datasets...
2025-10-18 17:04:05,707 - data_loader - INFO - Found 31 training cases
2025-10-18 17:04:05,707 - data_loader - INFO - Found 4 test cases
2025-10-18 17:04:05,707 - data_loader - INFO - Enhanced Dataset Info:
2025-10-18 17:04:05,707 - data_loader - INFO -  Training cases: 31
2025-10-18 17:04:05,707 - data_loader - INFO -  Test cases: 4
2025-10-18 17:04:05,707 - data_loader - INFO -  Target size: (64, 64, 64)
2025-10-18 17:04:05,707 - data_loader - INFO -  Target spacing: (1.5, 1.0, 1.0)
2025-10-18 17:04:05,707 - data_loader - INFO -  Normalization: robust
2025-10-18 17:04:05,707 - data_loader - INFO - Computing global statistics from 31 cases...
2025-10-18 17:04:12,337 - data_loader - INFO - Global statistics computed:
2025-10-18 17:04:12,338 - data_loader - INFO -   Mean: -55.44
2025-10-18 17:04:12,338 - data_loader - INFO -   Std: 100.41
2025-10-18 17:04:12,338 - data_loader - INFO -   Median: -125.00
2025-10-18 17:04:12,340 - data_loader - INFO - Loading 25 training cases with enhanced preprocessing...
2025-10-18 17:04:13,295 - data_loader - INFO - Loaded AUTO_SEG_1:
2025-10-18 17:04:13,296 - data_loader - INFO -   Image: torch.Size([1, 64, 64, 64]), range=[0.000, 1.000]
2025-10-18 17:04:13,296 - data_loader - INFO -   Mask: torch.Size([64, 64, 64]), labels=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10]
2025-10-18 17:04:14,431 - data_loader - INFO - Loaded AUTO_SEG_10:
2025-10-18 17:04:14,431 - data_loader - INFO -   Image: torch.Size([1, 64, 64, 64]), range=[0.000, 1.000]
2025-10-18 17:04:14,431 - data_loader - INFO -   Mask: torch.Size([64, 64, 64]), labels=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10]
2025-10-18 17:04:15,568 - data_loader - INFO - Loaded AUTO_SEG_11:
2025-10-18 17:04:15,568 - data_loader - INFO -   Image: torch.Size([1, 64, 64, 64]), range=[0.000, 1.000]
2025-10-18 17:04:15,568 - data_loader - INFO -   Mask: torch.Size([64, 64, 64]), labels=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
2025-10-18 17:04:38,656 - data_loader - INFO - Successfully loaded 25 cases
2025-10-18 17:04:38,656 - data_loader - INFO - Loading 4 test cases...
2025-10-18 17:04:43,088 - data_loader - INFO - Final enhanced dataset:
2025-10-18 17:04:43,088 - data_loader - INFO -  Training: 25 cases
2025-10-18 17:04:43,088 - data_loader - INFO -  Validation: 4 cases
2025-10-18 17:04:43,089 - data_loader - INFO -  Sample image: torch.Size([1, 64, 64, 64]), range=[0.000, 1.000]
2025-10-18 17:04:43,093 - data_loader - INFO -  Sample mask: torch.Size([64, 64, 64]), classes=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10]
2025-10-18 17:04:43,093 - __main__ - INFO - Loaded 25 training samples, 4 validation samples
2025-10-18 17:04:43,240 - __main__ - INFO - Training dataset: 20000 episodes
2025-10-18 17:04:43,240 - __main__ - INFO - Validation dataset: 5000 episodes
2025-10-18 17:04:43,240 - __main__ - INFO - Creating Iris model...
2025-10-18 17:04:43,574 - __main__ - INFO - Model Information:
2025-10-18 17:04:43,574 - __main__ - INFO -   total_parameters: 38885850
2025-10-18 17:04:43,574 - __main__ - INFO -   trainable_parameters: 38885850
2025-10-18 17:04:43,574 - __main__ - INFO -   embed_dim: 192
2025-10-18 17:04:43,574 - __main__ - INFO -   num_classes: 11
2025-10-18 17:04:43,574 - __main__ - INFO -   deep_supervision: False
2025-10-18 17:04:43,574 - __main__ - INFO -   multi_scale: True
2025-10-18 17:04:43,574 - __main__ - INFO -   model_size_mb: 148.3377456665039
2025-10-18 17:04:44,482 - fixed_episodic_trainer - INFO - Using Lamb optimizer with lr=0.001, wd=0.0001
2025-10-18 17:04:44,482 - fixed_episodic_trainer - INFO - Warmup iterations: 2000
2025-10-18 17:04:44,482 - fixed_episodic_trainer - INFO - Save interval: 10000
2025-10-18 17:04:44,483 - __main__ - INFO - Tensorboard logging enabled: outputs/training/iris_universal_segmentation/tensorboard
2025-10-18 17:04:44,483 - __main__ - INFO - Starting training...
2025-10-18 17:04:44,483 - fixed_episodic_trainer - INFO - Starting fixed episodic training...
2025-10-18 17:04:46,815 - fixed_episodic_trainer - INFO - Saved checkpoint: checkpoint_iter_0.pth
2025-10-18 17:32:42,517 - __main__ - INFO - Logging initialized. Output directory: outputs/training/iris_universal_segmentation
2025-10-18 17:32:42,517 - __main__ - INFO - ==================================================
2025-10-18 17:32:42,517 - __main__ - INFO - IRIS Framework Training
2025-10-18 17:32:42,517 - __main__ - INFO - Universal Medical Image Segmentation via In-Context Learning
2025-10-18 17:32:42,517 - __main__ - INFO - ==================================================
2025-10-18 17:32:42,517 - __main__ - INFO - Configuration: train_config_2.yaml
2025-10-18 17:32:42,517 - __main__ - INFO - Experiment: iris_universal_segmentation
2025-10-18 17:32:42,518 - __main__ - INFO - Output directory: outputs/training/iris_universal_segmentation
2025-10-18 17:32:42,668 - __main__ - INFO - Using device: cuda
2025-10-18 17:32:42,668 - __main__ - INFO - Loading datasets...
2025-10-18 17:32:42,671 - __main__ - ERROR - Failed to complete training: AMOS dataset folders not found at /users/student/rs/sandeep_k/IRIS/amos_data/amos22
2025-10-18 21:18:12,696 - __main__ - INFO - Training history saved to outputs/training/iris_universal_segmentation/training_history.pth
2025-10-18 21:18:12,697 - __main__ - INFO - ================================================================================
2025-10-18 21:18:12,697 - __main__ - INFO - STARTING DEEP DEBUG INFERENCE (5 samples)
2025-10-18 21:18:12,697 - __main__ - INFO - ================================================================================
2025-10-18 21:18:12,700 - data_loader - INFO - Found 31 training cases
2025-10-18 21:18:12,700 - data_loader - INFO - Found 4 test cases
2025-10-18 21:18:12,700 - data_loader - INFO - Enhanced Dataset Info:
2025-10-18 21:18:12,700 - data_loader - INFO -  Training cases: 31
2025-10-18 21:18:12,700 - data_loader - INFO -  Test cases: 4
2025-10-18 21:18:12,700 - data_loader - INFO -  Target size: (64, 64, 64)
2025-10-18 21:18:12,700 - data_loader - INFO -  Target spacing: (1.5, 1.0, 1.0)
2025-10-18 21:18:12,700 - data_loader - INFO -  Normalization: robust
2025-10-18 21:18:12,700 - data_loader - INFO - Computing global statistics from 31 cases...
2025-10-18 21:18:19,361 - data_loader - INFO - Global statistics computed:
2025-10-18 21:18:19,361 - data_loader - INFO -   Mean: -55.44
2025-10-18 21:18:19,361 - data_loader - INFO -   Std: 100.41
2025-10-18 21:18:19,361 - data_loader - INFO -   Median: -125.00
2025-10-18 21:18:19,363 - data_loader - INFO - Loading 25 training cases with enhanced preprocessing...
2025-10-18 21:18:20,276 - data_loader - INFO - Loaded AUTO_SEG_1:
2025-10-18 21:18:20,276 - data_loader - INFO -   Image: torch.Size([1, 64, 64, 64]), range=[0.000, 1.000]
2025-10-18 21:18:20,276 - data_loader - INFO -   Mask: torch.Size([64, 64, 64]), labels=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10]
2025-10-18 21:18:21,398 - data_loader - INFO - Loaded AUTO_SEG_10:
2025-10-18 21:18:21,398 - data_loader - INFO -   Image: torch.Size([1, 64, 64, 64]), range=[0.000, 1.000]
2025-10-18 21:18:21,398 - data_loader - INFO -   Mask: torch.Size([64, 64, 64]), labels=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10]
2025-10-18 21:18:22,525 - data_loader - INFO - Loaded AUTO_SEG_11:
2025-10-18 21:18:22,526 - data_loader - INFO -   Image: torch.Size([1, 64, 64, 64]), range=[0.000, 1.000]
2025-10-18 21:18:22,526 - data_loader - INFO -   Mask: torch.Size([64, 64, 64]), labels=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
2025-10-18 21:18:45,439 - data_loader - INFO - Successfully loaded 25 cases
2025-10-18 21:18:45,439 - data_loader - INFO - Loading 4 test cases...
2025-10-18 21:18:49,793 - data_loader - INFO - Final enhanced dataset:
2025-10-18 21:18:49,794 - data_loader - INFO -  Training: 25 cases
2025-10-18 21:18:49,794 - data_loader - INFO -  Validation: 4 cases
2025-10-18 21:18:49,794 - data_loader - INFO -  Sample image: torch.Size([1, 64, 64, 64]), range=[0.000, 1.000]
2025-10-18 21:18:49,797 - data_loader - INFO -  Sample mask: torch.Size([64, 64, 64]), classes=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10]
2025-10-18 21:18:49,801 - __main__ - INFO - [TASK] Reference Class ID: 2
2025-10-18 21:18:49,801 - __main__ - INFO - [TASK] Ref Mask Shape (Binary): torch.Size([1, 1, 64, 64, 64])
2025-10-18 21:18:49,801 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-18 21:18:49,801 - __main__ - INFO - Processing Sample 1/4
2025-10-18 21:18:49,874 - __main__ - INFO - [METRIC] Dice Score (Task 2 overlap): 0.5335
2025-10-18 21:18:50,293 - __main__ - INFO - [FILES] Debug files saved to: outputs/training/iris_universal_segmentation/debug_inference/sample_0
2025-10-18 21:18:50,479 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-18 21:18:50,479 - __main__ - INFO - Processing Sample 2/4
2025-10-18 21:18:50,553 - __main__ - INFO - [METRIC] Dice Score (Task 2 overlap): 0.5931
2025-10-18 21:18:50,967 - __main__ - INFO - [FILES] Debug files saved to: outputs/training/iris_universal_segmentation/debug_inference/sample_1
2025-10-18 21:18:51,137 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-18 21:18:51,137 - __main__ - INFO - Processing Sample 3/4
2025-10-18 21:18:51,214 - __main__ - INFO - [METRIC] Dice Score (Task 2 overlap): 0.6139
2025-10-18 21:18:51,634 - __main__ - INFO - [FILES] Debug files saved to: outputs/training/iris_universal_segmentation/debug_inference/sample_2
2025-10-18 21:18:51,806 - __main__ - INFO - --------------------------------------------------------------------------------
2025-10-18 21:18:51,806 - __main__ - INFO - Processing Sample 4/4
2025-10-18 21:18:51,884 - __main__ - INFO - [METRIC] Dice Score (Task 2 overlap): 0.5411
2025-10-18 21:18:52,293 - __main__ - INFO - [FILES] Debug files saved to: outputs/training/iris_universal_segmentation/debug_inference/sample_3
2025-10-18 21:18:52,469 - __main__ - INFO - ================================================================================
2025-10-18 21:18:52,469 - __main__ - INFO - FINAL AVG DICE over 4 samples: 0.5704
2025-10-18 21:18:52,469 - __main__ - INFO - ================================================================================
2025-10-18 21:18:52,469 - __main__ - INFO - Training and demonstration completed successfully!
